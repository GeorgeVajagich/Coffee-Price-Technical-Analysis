---
title: "Coffee Price Technical Analysis"
author: "George Vajagich"
date: "11/30/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
options(readr.show_col_types = FALSE)
library(ggplot2)
library(lubridate)
library(scales)
library(dplyr)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

df=read_csv("Coffee_Price_Since_1973.csv")
df$date<- mdy(df$date)

```


```{r, echo=FALSE}
ggplot(data = df, aes(x = date, y = value, group = 1))+
  geom_line()+
  scale_x_date(breaks="5 years", labels = date_format("%Y"))
```

```{r}
head(df)
```

```{r}
df <- df %>% mutate(one_day_past = lag(value,n=1))
df <- df %>% mutate_at(c("value"), tibble::lst("one_day_future"=lead), n = 1)
```


```{r}
df <- df %>% mutate(next_one_day_performance=(one_day_future/value-1)*100)
df  <- df %>% mutate(past_one_day_performance=(value/one_day_past-1)*100)
```


```{r}
cor(df$past_one_day_performance, df$next_one_day_performance, use = "complete.obs")
ggplot(df, aes(x=past_one_day_performance, y=next_one_day_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(five_days_past = lag(value,n=5))
df <- df %>% mutate_at(c("value"), tibble::lst("five_days_future"=lead), n = 5)
```

```{r}
df <- df %>% mutate(next_five_days_performance=(five_days_future/value-1)*100)
df  <- df %>% mutate(past_five_days_performance=(value/five_days_past-1)*100)
```

```{r}
cor(df$past_five_days_performance, df$next_five_days_performance, use = "complete.obs")
ggplot(df, aes(x=past_five_days_performance, y=next_five_days_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(twenty_days_past = lag(value,n=20))
df <- df %>% mutate_at(c("value"), tibble::lst("twenty_days_future"=lead), n = 20)
```

```{r}
df <- df %>% mutate(next_twenty_days_performance=(twenty_days_future/value-1)*100)
df  <- df %>% mutate(past_twenty_days_performance=(value/twenty_days_past-1)*100)
```

```{r}
cor(df$past_twenty_days_performance, df$next_twenty_days_performance, use = "complete.obs")
ggplot(df, aes(x=past_twenty_days_performance, y=next_twenty_days_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(one_year_past = lag(value,n=240))
df <- df %>% mutate_at(c("value"), tibble::lst("one_year_future"=lead), n = 240)
```

```{r}
df <- df %>% mutate(next_one_year_performance=(one_year_future/value-1)*100)
df  <- df %>% mutate(past_one_year_performance=(value/one_year_past-1)*100)
```

```{r}
cor(df$past_one_year_performance, df$next_one_year_performance, use = "complete.obs")
ggplot(df, aes(x=past_one_year_performance, y=next_one_year_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```


```{r}
df <- df %>% mutate(two_years_past = lag(value,n=480))
df <- df %>% mutate_at(c("value"), tibble::lst("two_years_future"=lead), n = 480)
```

```{r}
df <- df %>% mutate(next_two_years_performance=(two_years_future/value-1)*100)
df  <- df %>% mutate(past_two_years_performance=(value/two_years_past-1)*100)
```

```{r}
cor(df$past_two_years_performance, df$next_two_years_performance, use = "complete.obs")
ggplot(df, aes(x=past_two_years_performance, y=next_two_years_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```


```{r}
df <- df %>% mutate(three_years_past = lag(value,n=720))
df <- df %>% mutate_at(c("value"), tibble::lst("three_years_future"=lead), n = 720)
```

```{r}
df <- df %>% mutate(next_three_years_performance=(three_years_future/value-1)*100)
df  <- df %>% mutate(past_three_years_performance=(value/three_years_past-1)*100)
```

```{r}
cor(df$past_three_years_performance, df$next_three_years_performance, use = "complete.obs")
ggplot(df, aes(x=past_three_years_performance, y=next_three_years_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```


```{r}
df <- df %>% mutate(four_years_past = lag(value,n=960))
df <- df %>% mutate_at(c("value"), tibble::lst("four_years_future"=lead), n = 960)
```

```{r}
df <- df %>% mutate(next_four_years_performance=(four_years_future/value-1)*100)
df  <- df %>% mutate(past_four_years_performance=(value/four_years_past-1)*100)
```

```{r}
cor(df$past_four_years_performance, df$next_four_years_performance, use = "complete.obs")
ggplot(df, aes(x=past_four_years_performance, y=next_four_years_performance)) + geom_point(size=0.5) + theme(aspect.ratio=1)
```