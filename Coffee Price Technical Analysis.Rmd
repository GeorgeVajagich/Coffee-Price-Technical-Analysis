---
title: "Coffee Price Technical Analysis"
author: "George Vajagich"
date: "1/18/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
options(readr.show_col_types = FALSE)
library(ggplot2)
library(lubridate)
library(scales)
library(dplyr)
library(grid)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

df=read_csv("Coffee_Price_Since_1973.csv")
df$date<- mdy(df$date)

```


```{r, echo=FALSE}
ggplot(data = df, aes(x = date, y = value, group = 1))+
  geom_line()+
  scale_x_date(breaks="5 years", labels = date_format("%Y"))
```

```{r}
head(df)
```

```{r}
df <- df %>% mutate(one_day_past = lag(value,n=1))
df <- df %>% mutate_at(c("value"), tibble::lst("one_day_future"=lead), n = 1)
```


```{r}
df <- df %>% mutate(next_one_day_performance=(one_day_future/value-1)*100)
df  <- df %>% mutate(past_one_day_performance=(value/one_day_past-1)*100)
```


```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_one_day_performance, df$next_one_day_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_one_day_performance, y=next_one_day_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(week_past = lag(value,n=5))
df <- df %>% mutate_at(c("value"), tibble::lst("week_future"=lead), n = 5)
```

```{r}
df <- df %>% mutate(next_week_performance=(week_future/value-1)*100)
df  <- df %>% mutate(past_week_performance=(value/week_past-1)*100)
```

```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_week_performance, df$next_week_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_week_performance, y=next_week_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(month_past = lag(value,n=20))
df <- df %>% mutate_at(c("value"), tibble::lst("month_future"=lead), n = 20)
```

```{r}
df <- df %>% mutate(next_month_performance=(month_future/value-1)*100)
df  <- df %>% mutate(past_month_performance=(value/month_past-1)*100)
```

```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_month_performance, df$next_month_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_month_performance, y=next_month_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```



```{r}
df <- df %>% mutate(one_year_past = lag(value,n=240))
df <- df %>% mutate_at(c("value"), tibble::lst("one_year_future"=lead), n = 240)
```

```{r}
df <- df %>% mutate(next_one_year_performance=(one_year_future/value-1)*100)
df  <- df %>% mutate(past_one_year_performance=(value/one_year_past-1)*100)
```

```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_one_year_performance, df$next_one_year_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_one_year_performance, y=next_one_year_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```


```{r}
df <- df %>% mutate(two_years_past = lag(value,n=480))
df <- df %>% mutate_at(c("value"), tibble::lst("two_years_future"=lead), n = 480)
```

```{r}
df <- df %>% mutate(next_two_years_performance=(two_years_future/value-1)*100)
df  <- df %>% mutate(past_two_years_performance=(value/two_years_past-1)*100)
```

```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_two_years_performance, df$next_two_years_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_two_years_performance, y=next_two_years_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```





```{r}
df <- df %>% mutate(five_years_past = lag(value,n=1200))
df <- df %>% mutate_at(c("value"), tibble::lst("five_years_future"=lead), n = 1200)
```

```{r}
df <- df %>% mutate(next_five_years_performance=(five_years_future/value-1)*100)
df  <- df %>% mutate(past_five_years_performance=(value/five_years_past-1)*100)
```

```{r}
grob = grobTree(textGrob(paste("Correlation : ", round(cor(df$past_five_years_performance, df$next_five_years_performance, use = "complete.obs"),4)), x = 0.75, y = 0.95, gp = gpar(col = "red", fontsize = 12)))

ggplot(df, aes(x=past_five_years_performance, y=next_five_years_performance)) + geom_point(size=0.5) + annotation_custom(grob) + theme(aspect.ratio=1)
```

